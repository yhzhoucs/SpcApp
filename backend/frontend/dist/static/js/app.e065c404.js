(function(t){function e(e){for(var o,r,c=e[0],i=e[1],s=e[2],d=0,f=[];d<c.length;d++)r=c[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&f.push(a[r][0]),a[r]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);l&&l(e);while(f.length)f.shift()();return u.push.apply(u,s||[]),n()}function n(){for(var t,e=0;e<u.length;e++){for(var n=u[e],o=!0,r=1;r<n.length;r++){var c=n[r];0!==a[c]&&(o=!1)}o&&(u.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},r={app:0},a={app:0},u=[];function c(t){return i.p+"static/js/"+({}[t]||t)+"."+{"chunk-1c79023d":"8c581a07","chunk-228a36de":"6411b400","chunk-2d0a2df4":"c474b38f","chunk-506f60ad":"e1c86553","chunk-5b60dfd0":"0f1eee89","chunk-a7b5da0a":"e669e41f","chunk-2d0c9399":"db210da1","chunk-2d212c60":"3ead8a92","chunk-aa2e4938":"d7c2aba5","chunk-c4ac363c":"e14b347f"}[t]+".js"}function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(t){var e=[],n={"chunk-1c79023d":1,"chunk-506f60ad":1,"chunk-aa2e4938":1,"chunk-c4ac363c":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise((function(e,n){for(var o="static/css/"+({}[t]||t)+"."+{"chunk-1c79023d":"cf3e4bbd","chunk-228a36de":"31d6cfe0","chunk-2d0a2df4":"31d6cfe0","chunk-506f60ad":"07a26709","chunk-5b60dfd0":"31d6cfe0","chunk-a7b5da0a":"31d6cfe0","chunk-2d0c9399":"31d6cfe0","chunk-2d212c60":"31d6cfe0","chunk-aa2e4938":"18808053","chunk-c4ac363c":"6c199080"}[t]+".css",a=i.p+o,u=document.getElementsByTagName("link"),c=0;c<u.length;c++){var s=u[c],d=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(d===o||d===a))return e()}var f=document.getElementsByTagName("style");for(c=0;c<f.length;c++){s=f[c],d=s.getAttribute("data-href");if(d===o||d===a)return e()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=e,l.onerror=function(e){var o=e&&e.target&&e.target.src||a,u=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");u.code="CSS_CHUNK_LOAD_FAILED",u.request=o,delete r[t],l.parentNode.removeChild(l),n(u)},l.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(l)})).then((function(){r[t]=0})));var o=a[t];if(0!==o)if(o)e.push(o[2]);else{var u=new Promise((function(e,n){o=a[t]=[e,n]}));e.push(o[2]=u);var s,d=document.createElement("script");d.charset="utf-8",d.timeout=120,i.nc&&d.setAttribute("nonce",i.nc),d.src=c(t);var f=new Error;s=function(e){d.onerror=d.onload=null,clearTimeout(l);var n=a[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",f.name="ChunkLoadError",f.type=o,f.request=r,n[1](f)}a[t]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:d})}),12e4);d.onerror=d.onload=s,document.head.appendChild(d)}return Promise.all(e)},i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i.oe=function(t){throw console.error(t),t};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],d=s.push.bind(s);s.push=e,s=s.slice();for(var f=0;f<s.length;f++)e(s[f]);var l=d;u.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"56d7":function(t,e,n){"use strict";n.r(e);n("d3b7");var o=n("5530"),r=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},u=[],c=(n("034f"),n("2877")),i={},s=Object(c["a"])(i,a,u,!1,null,null,null),d=s.exports,f=n("8c4f");r["default"].use(f["a"]);var l=[{path:"/login",name:"Login",component:function(){return Promise.all([n.e("chunk-a7b5da0a"),n.e("chunk-2d0c9399")]).then(n.bind(null,"57de"))}}],h=[{path:"/",redirect:{path:"/home"}},{path:"/home",name:"Home",component:function(){return n.e("chunk-1c79023d").then(n.bind(null,"bb51"))},children:[{path:"productManager",component:function(){return n.e("chunk-aa2e4938").then(n.bind(null,"a96f"))},meta:{role:["admin","super_editor"],isSidebarItem:!0,sidebarInfo:{name:"零件管理",iconClass:"icon-plus-circle"}}},{path:"workshopManager",component:function(){return n.e("chunk-228a36de").then(n.bind(null,"54e8"))},meta:{role:["admin","super_editor"],isSidebarItem:!0,sidebarInfo:{name:"车间管理",iconClass:"icon-archive1"}}},{path:"accountSettings",component:function(){return Promise.all([n.e("chunk-a7b5da0a"),n.e("chunk-2d212c60")]).then(n.bind(null,"aa9c"))},meta:{role:["admin","super_editor","viewer"],isSidebarItem:!0,sidebarInfo:{name:"账户设置",iconClass:"icon-user1"}}},{path:"analysisReports",component:function(){return n.e("chunk-2d0a2df4").then(n.bind(null,"0086"))},meta:{role:["admin","super_editor","viewer"],isSidebarItem:!0,sidebarInfo:{name:"异常警报",iconClass:"icon-bell"}}},{path:"analysisReportDetail/:index",name:"ReportDetail",component:function(){return n.e("chunk-5b60dfd0").then(n.bind(null,"9c37"))},meta:{role:["admin","super_editor","viewer"],isSidebarItem:!1}},{path:"controlGraph/:proIndex/:parIndex",component:function(){return n.e("chunk-c4ac363c").then(n.bind(null,"0710"))},meta:{role:["admin","super_editor","viewer"],isSidebarItem:!1}},{path:"404",name:"Small404",component:function(){return n.e("chunk-506f60ad").then(n.bind(null,"2a3e"))}}],meta:{role:["admin","super_editor","viewer"],isSidebarItem:!1}},{path:"/404",component:function(){return n.e("chunk-506f60ad").then(n.bind(null,"2a3e"))}},{path:"*",redirect:"/404",hidden:!0}],p=new f["a"]({mode:"history",base:"/",routes:l}),m=p,g=n("2f62"),b=n("bc3a"),k=n.n(b),v={confirmLogin:function(t,e,n,o){k.a.post("/api/user/ConfirmLogin",t).then((function(t){var o=t.data.status;"success"===o?e(t.data.token):n(t.data.errorMsg)})).catch((function(){o("请求失败！")}))},getUserInfo:function(t,e,n){k.a.get("api/user/GetUserInfo").then((function(n){var o=n.data.status;"success"===o?t(n.data.user):e(n.data.errorMsg)})).catch((function(){return n("请求失败！")}))},updateUserInfo:function(t,e,n,o){k.a.post("/api/user/UpdateUserInfo",t).then((function(t){"success"===t.data.status?e(t.data.user):n(t.data.errorMsg)})).catch((function(){o("请求失败！")}))},modifyPwd:function(t,e,n,o){k.a.post("/api/user/ModifyPassword",t).then((function(t){"success"===t.data.status?e():n(t.data.errorMsg)})).catch((function(){o("请求失败！")}))}},w=v,P=function(){return{status:"",token:localStorage.getItem("token")||"",user:null}},y={authRequest:function(t){t.status="auth_loading"},authSuccess:function(t,e){t.status="auth_success",t.token=e},authFail:function(t){t.status="auth_fail"},authError:function(t){t.status="auth_error"},setUser:function(t,e){t.user=e},logout:function(t){t.status="",t.token=""},updateUser:function(t,e){console.log("Here in mutations"),console.log(e),t.user=e}},I={login:function(t,e){var n=t.commit;return new Promise((function(t,o){n("authRequest"),w.confirmLogin(e,(function(e){localStorage.setItem("token",e),k.a.defaults.headers.common["Authentication"]=e,n("authSuccess",e),t()}),(function(t){n("authFail"),localStorage.removeItem("token"),o(t)}),(function(t){n("authError"),localStorage.removeItem("token"),o(t)}))}))},logout:function(t){var e=t.commit;return new Promise((function(t,n){e("logout");try{localStorage.removeItem("token"),delete k.a.defaults.headers.common["Authorization"],t()}catch(o){n(o)}}))},getUserInfo:function(t){var e=t.commit;return new Promise((function(t,n){w.getUserInfo((function(n){e("setUser",n),t(n)}),(function(t){return n(t)}),(function(t){return n(t)}))}))},updateUserInfo:function(t,e){var n=t.commit;return new Promise((function(t,o){w.updateUserInfo(e,(function(e){n("updateUser",e),t()}),(function(t){return o(t)}),(function(t){return o(t)}))}))},modifyPwd:function(t){return new Promise((function(e,n){w.modifyPwd(t,(function(){e()}),(function(t){return n(t)}),(function(t){return n(t)}))}))}},R={isLoggedIn:function(t){return!!t.token},authStatus:function(t){return t.status},currentUser:function(t){return t.user}},S={namespaced:!0,state:P,getters:R,actions:I,mutations:y},_=(n("a434"),n("5a7b")),A=function(){return{status:"",all:[]}},x={loading:function(t){t.status="loading"},loadFail:function(t){t.status="fail"},setProducts:function(t,e){t.status="loaded",t.all=e},addProduct:function(t,e){t.all.push(e)},deleteProduct:function(t,e){t.all.splice(e,1)},modifyProduct:function(t,e){t.all[e.index]=e.product;var n=t.all;t.all=[],t.all=n}},M={getAllProducts:function(t){var e=t.commit;return new Promise((function(t,n){e("loading"),_["a"].getAllProducts((function(n){e("setProducts",n),t(n)}),(function(t){return n(t)}),(function(t){return n(t)}))}))},submitProduct:function(t,e){var n=t.commit,o=e.productForm,r=e.modification;return new Promise((function(t,e){n("loading"),_["a"].submitProduct(o,r.modify,(function(e){r.modify?(n("modifyProduct",{index:r.index,product:e}),t("修改成功！")):(n("addProduct",e),t("添加成功！"))}),(function(t){e(t)}),(function(t){n("loadFail"),e(t)}))}))},deleteProduct:function(t,e){var n=t.commit,o=t.state;return new Promise((function(t,r){_["a"].deleteProduct(o.all[e].id,(function(){n("deleteProduct",e),t()}),(function(t){return r(t)}),(function(t){return r(t)}))}))}},U={allProducts:function(t){return t.all},loadStatus:function(t){return t.status}},E={namespaced:!0,state:A,getters:U,actions:M,mutations:x},O=function(){return{status:"",all:[]}},j={loading:function(t){t.status="loading"},loadFail:function(t){t.status="fail"},setReports:function(t,e){t.status="loaded",t.all=e},markReportAsRead:function(t,e){if(!t.all[e].read){for(var n=t.all,o=e,r=n[o];o<n.length-1;++o){if(n[o+1].read)break;n[o]=n[o+1]}r.read=!0,n[o]=r,t.all=null,t.all=n}}},C={getAllExceptionReports:function(t){var e=t.commit;return new Promise((function(t,n){_["a"].getAllExceptionReports((function(n){e("setReports",n),t()}),(function(t){return n(t)}),(function(t){return n(t)}))}))},getReportDetailHtml:function(t,e){var n=t.commit;return new Promise((function(t,o){_["a"].getReportDetailHtml(e.id,(function(o){n("markReportAsRead",e.index),t(o)}),(function(t){return o(t)}),(function(t){return o(t)}))}))}},D={reports:function(t){return t.all},hasReport:function(t){return t.all.length>0},numberOfUnreadReports:function(t){var e=t.all;if(0===e.length)return 0;var n=0,o=e.length-1;while(o-n>1){var r=n+Math.floor((o-n)/2);e[r].read?o=r:n=r}return e[n].read?n:e[o].read?n+1:o+1}},G={namespaced:!0,state:O,getters:D,actions:C,mutations:j};n("99af"),n("4de4"),n("c975");function L(t,e){return!e.meta||!e.meta.role||e.meta.role.indexOf(t)>=0}var T=function(){return{routes:l,customRoutes:[]}},F={setRoutes:function(t,e){t.customRoutes=e,t.routes=l.concat(e)}},H={generateRoutes:function(t,e){var n=t.commit;return new Promise((function(t){var o=h.filter((function(t){return!!L(e,t)&&(t.children&&t.children.length>0&&(t.children=t.children.filter((function(t){return!!L(e,t)&&t}))),t)}));n("setRoutes",o),t()}))}},W={routes:function(t){return t.routes},customRoutes:function(t){return t.customRoutes}},q={namespaced:!0,state:T,getters:W,actions:H,mutations:F};r["default"].use(g["a"]);var N=new g["a"].Store({modules:{user:S,products:E,exceptions:G,permission:q}}),B=N,J=n("2106"),$=n.n(J),z=(n("4989"),n("ab8b"),n("5aea"),n("710a"),n("5887")),K=n.n(z);r["default"].use($.a,k.a),r["default"].config.productionTip=!1,k.a.interceptors.request.use((function(t){var e=localStorage.getItem("token");return e&&(t.headers.common["Authentication"]=e),t}),(function(t){return Promise.reject(t)})),m.beforeEach((function(t,e,n){if(B.getters["user/isLoggedIn"]){var r=B.getters["user/currentUser"];r&&r.role?n():B.dispatch("user/getUserInfo").then((function(e){B.dispatch("permission/generateRoutes",e.role).then((function(){m.addRoutes(B.getters["permission/customRoutes"]),console.log(m.getRoutes()),n(Object(o["a"])(Object(o["a"])({},t),{},{replace:!0}))}))})).catch((function(t){return console.log(t)}))}else"/login"===t.fullPath?n():n("/login")})),r["default"].use(K.a),new r["default"]({router:m,store:B,render:function(t){return t(d)}}).$mount("#app")},"5a7b":function(t,e,n){"use strict";var o=n("bc3a"),r=n.n(o),a={submitProduct:function(t,e,n,o,a){r.a.post("/api/workshop/SubmitProduct",{product:t,modify:e}).then((function(t){"success"===t.data.status?n(t.data.product):o(t.data.errorMsg)})).catch((function(){a("请求失败！")}))},getAllExceptionReports:function(t,e,n){r.a.get("/api/workshop/GetAllExceptionReports").then((function(n){"success"===n.data.status?t(n.data.reports):e(n.data.errorMsg)})).catch((function(){n("请求失败！")}))},getReportDetailHtml:function(t,e,n,o){r.a.get("/api/workshop/GetReportDetailHtml?id="+t).then((function(t){"success"===t.data.status?e(t.data.content):n(t.data.errorMsg)})).catch((function(){o("请求失败！")}))},getAllProducts:function(t,e,n){r.a.get("/api/workshop/GetAllProducts").then((function(n){"success"===n.data.status?t(n.data.products):e()})).catch((function(){n()}))},deleteProduct:function(t,e,n,o){r.a.get("/api/workshop/DeleteProduct?id="+t).then((function(t){"success"===t.data.status?e():n(t.data.errorMsg)})).catch((function(){o("请求失败！")}))},getControlGraph:function(t,e){r.a.post("/api/workshop/GetControlGraph",t).then((function(t){var n=t.data;"success"===n.status&&n.updated&&e(n.options,n.tmp_point_id)})).catch((function(t){return console.log(t)}))},getDynamicAnalysisReport:function(t,e,n){r.a.post("/api/workshop/GetControlGraph",t).then((function(t){var n=t.data;"success"===n.status&&e(n.content)})).catch((function(){return n("请求失败！")}))},getAllWorkshopsInfo:function(t,e){r.a.get("/api/workshop/GetAllWorkshopsInfo").then((function(n){"success"===n.data.status?t(n.data.workshops):e(n.data.errorMsg)})).catch((function(){return e("请求错误！")}))},submitWorkshop:function(t,e,n,o){r.a.post("/api/workshop/SubmitWorkshop",t).then((function(t){"success"===t.data.status?e(t.data.workshop):n(t.data.errorMsg)})).catch((function(){return o("请求失败！")}))},deleteWorkshop:function(t,e,n,o){r.a.get("/api/workshop/DeleteWorkshop?id="+t).then((function(t){"success"===t.data.status?e():n(t.data.errorMsg)})).catch((function(){return o("请求失败！")}))}};e["a"]=a},"5aea":function(t,e,n){},"710a":function(t,e,n){},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.e065c404.js.map